# DS18B20 — 1-Wire Temperature Sensor
**Driver:** `WyDS18B20.h`

---

## What it does
Waterproof digital temperature sensor. One wire carries power, ground, and data. Multiple sensors can share a single GPIO pin. Accurate to ±0.5°C, -55°C to +125°C.

## Why it's great
- **Waterproof** — the common stainless steel probe version lives in liquids, soil, pipes, tanks
- **Multiple sensors, one pin** — up to 127 DS18B20s on a single GPIO
- **No calibration** — factory-calibrated, accurate out of the box
- **Long cable runs** — works over 100m of cable

## Wiring
**Standard (external power):**
| DS18B20 | ESP32 |
|---------|-------|
| GND (black) | GND |
| VDD (red) | 3.3V |
| DQ (yellow) | GPIO + 4.7kΩ to 3.3V |

**The 4.7kΩ pull-up resistor is not optional.** Without it the bus hangs LOW and nothing works.

## Multiple sensors on one pin
```cpp
sensors.addGPIO<WyDS18B20>("water",  4);     // index 0 (first found)
sensors.addGPIO<WyDS18B20>("ambient", 4, 1); // index 1 (second found)
sensors.addGPIO<WyDS18B20>("inlet",   4, 2); // index 2 (third found)
```

The driver does a 1-Wire search on `begin()` for index > 0, storing the ROM address for that specific sensor.

## ⚠️ Timing is critical
1-Wire uses precise timing — the bit-banging requires µs-level accuracy. The driver uses `noInterrupts()` during reads. Long ISRs or heavy WiFi activity can corrupt reads. If you see CRC failures:
- Move DS18B20 reads away from WiFi-heavy periods
- Reduce cable length
- Use a stronger pull-up (2.2kΩ instead of 4.7kΩ for long runs)

## CRC failure — what it means
The DS18B20 sends a CRC byte with every reading. If the driver returns `d.error = "CRC fail"`, the data was corrupted in transit. This is almost always a wiring issue:
1. Pull-up resistor missing or wrong value
2. Cable too long
3. Too many sensors (over ~10 on one pin, parasitic power especially)
4. Interrupt interference during read

## Parasitic power mode
If you only connect two wires (GND + DQ, no VDD), the sensor powers itself from the data line. Works but has limitations: slower conversion, shorter cable runs, fewer sensors per bus. Not recommended. Use 3-wire external power.

## Conversion time
12-bit resolution (default) takes **750ms** to convert. The driver waits for the conversion complete signal rather than a fixed delay. If you need faster readings, reduce resolution:
```cpp
// 9-bit resolution: 93.75ms conversion, ±0.5°C accuracy
ds->setResolution(9);  // (not yet in driver — TODO)
```

## Fish tank / aquarium use
Perfect for aquarium monitoring:
- One probe in the water for temperature compensation with the pH sensor
- Second probe measuring ambient air outside the tank
- Third probe on the sump/filter output

All on a single GPIO pin.
