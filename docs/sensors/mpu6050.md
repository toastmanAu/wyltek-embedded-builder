# MPU-6050 — 6-DoF IMU (Accelerometer + Gyroscope)
**Driver:** `WyMPU6050.h`

---

## What it does
Measures acceleration in three axes (X, Y, Z) and rotation rate in three axes. From the accelerometer data alone you can calculate tilt (roll and pitch). Combine with the gyroscope to get smoother motion tracking. The on-die temperature sensor measures chip temperature, not ambient air.

## Common uses
- Tilt detection (is the device flat? tilted?)
- Gesture recognition (tap, shake, freefall)
- Orientation for displays (landscape vs portrait)
- Stabilisation (gimbal, drone flight controller — needs sensor fusion)
- Step counting, impact detection, vibration monitoring

## Wiring

| MPU6050 Pin | ESP32 |
|------------|-------|
| VCC | 3.3V |
| GND | GND |
| SDA | GPIO (any I2C SDA) |
| SCL | GPIO (any I2C SCL) |
| AD0 | GND for 0x68, 3.3V for 0x69 |
| INT | Optional interrupt GPIO |

## I2C Addresses

| AD0 Pin | Address |
|---------|---------|
| GND (or floating) | `0x68` |
| 3.3V | `0x69` |

## Specs

| Parameter | Options |
|-----------|---------|
| Accelerometer range | ±2g / ±4g / ±8g / ±16g |
| Gyroscope range | ±250 / ±500 / ±1000 / ±2000 °/s |
| Sample rate | Up to 8kHz (gyro), 1kHz (accel) |
| Interface | I2C, 400kHz |
| Supply | 3.3V (some modules need 5V input with regulator) |

## Code Example

```cpp
#include <WySensors.h>
#include <sensors/drivers/WyMPU6050.h>

WySensors sensors;
WyMPU6050* imu;

void setup() {
    imu = sensors.addI2C<WyMPU6050>("imu", 21, 22, 0x68);
    sensors.begin();
}

void loop() {
    // Standard read — temperature and accel magnitude only
    WySensorData d = sensors.read("imu");

    // Full IMU data — use readIMU() directly
    WyIMUData m = imu->readIMU();
    if (m.ok) {
        Serial.printf("Roll: %.1f°  Pitch: %.1f°\n", m.roll, m.pitch);
        Serial.printf("Accel: %.2f %.2f %.2f g\n", m.ax, m.ay, m.az);
        Serial.printf("Gyro:  %.1f %.1f %.1f °/s\n", m.gx, m.gy, m.gz);
    }
    delay(20);
}
```

## WyIMUData structure

Returned by `imu->readIMU()`:

| Field | Content |
|-------|---------|
| `ax, ay, az` | Accelerometer X/Y/Z in g |
| `gx, gy, gz` | Gyroscope X/Y/Z in °/s |
| `temp` | Die temperature in °C |
| `accelMag` | `√(ax²+ay²+az²)` — total acceleration |
| `roll` | Roll angle from accelerometer (°) |
| `pitch` | Pitch angle from accelerometer (°) |
| `ok` | `true` if read succeeded |

## Calibration

```cpp
// Place sensor flat and still, then call once:
imu->calibrate(200);  // averages 200 samples, prints offsets to Serial
// Output: [MPU6050] accel bias: 0.012 -0.007 0.985
//         [MPU6050] gyro bias:  0.023 -0.015 0.008
// Apply these offsets in your app to zero the readings
```

## Accelerometer ranges

| Constant | Range | LSB | Best for |
|----------|-------|-----|---------|
| `MPU6050_ACCEL_2G` | ±2g | 16384/g | Low-vibration, precision tilt |
| `MPU6050_ACCEL_8G` | ±8g | 4096/g | General use (default) |
| `MPU6050_ACCEL_16G` | ±16g | 2048/g | High-impact, shock detection |

## Gyroscope ranges

| Constant | Range | LSB |
|----------|-------|-----|
| `MPU6050_GYRO_250` | ±250°/s | 131.0 |
| `MPU6050_GYRO_500` | ±500°/s | 65.5 (default) |
| `MPU6050_GYRO_2000` | ±2000°/s | 16.4 |

## Gotchas

**Default is SLEEP mode.** The MPU6050 powers on in sleep mode. The driver wakes it up on `begin()`. If you see all zeros from a manual register read, you forgot to wake the chip.

**Roll/pitch from accel only — drifts under motion.** The driver calculates roll and pitch purely from accelerometer data. This works when stationary (gravity is the only acceleration) but is wrong during movement. For accurate orientation under motion, implement a complementary filter or Kalman filter using both accel and gyro.

**WHO_AM_I verification.** The driver reads register `0x75` expecting `0x68`, `0x69`, or `0x70`. Clone chips sometimes return `0x72` — if `begin()` fails, check the actual value and update the check if needed.

**GY-521 breakout board.** Most MPU6050 modules are GY-521. They have an onboard 3.3V regulator and can accept 5V on VCC. The I2C pins are still 3.3V — don't apply 5V to SDA/SCL.

**Temperature reads ~35–45°C always.** The die temperature depends on the chip's power dissipation and ambient. Don't use this to measure room temperature — it's a die temperature for factory use.

**FIFO is available but not used.** The MPU6050 has a 1024-byte FIFO for burst data capture. This driver uses streaming mode (direct register reads). For high-rate data logging, use the FIFO via the raw register access.
