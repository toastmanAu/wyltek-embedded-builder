# ENS160 + AHT21 — Digital Air Quality
**Driver:** `WyENS160.h` + `WyAHT20.h`

---

## What they do
**ENS160** — PixArt digital MOX air quality sensor. Detects eCO2 (equivalent CO2 in ppm), TVOC (total volatile organic compounds in ppb), and outputs an AQI (Air Quality Index) score 1–5. Onboard AI/ML algorithm, handles its own baseline.

**AHT21** — temperature and humidity sensor. On the combo board, feeds temperature and humidity compensation data to the ENS160 for accurate readings.

## ENS160 vs SGP30 — which to choose?
| Feature | ENS160 | SGP30 |
|---------|--------|-------|
| Algorithm | Onboard AI/ML | Algorithm on host |
| Baseline | Internal, self-managed | You manage in NVS |
| Warm-up on boot | ~3 minutes initial, then instant | 15 seconds every boot |
| AQI output | Built-in (1–5 UBA) | No |
| Compensation | Mandatory T+RH input | Optional |
| Accuracy | Better | Good |

**ENS160 wins for most projects.** The SGP30 gives you more raw access if you want to build custom algorithms.

## AQI scale (UBA — Umweltbundesamt)
| AQI | Label | eCO2 | TVOC |
|-----|-------|------|------|
| 1 | Excellent | <600 ppm | <65 ppb |
| 2 | Good | 600–800 ppm | 65–220 ppb |
| 3 | Moderate | 800–1000 ppm | 220–660 ppb |
| 4 | Poor | 1000–1500 ppm | 660–2200 ppb |
| 5 | Unhealthy | >1500 ppm | >2200 ppb |

Outdoor fresh air: ~420 ppm CO2. Crowded room: 1000–2000+ ppm.

## Compensation — not optional
The ENS160 datasheet explicitly states: without T+RH compensation, eCO2/TVOC readings are significantly less accurate. The AHT21 is on the same board for exactly this reason.

**Always read AHT21 first, then compensate ENS160:**
```cpp
WySensorData th = sensors.read("humidity");
if (th.ok) ens->compensate(th.temperature, th.humidity);
WySensorData air = sensors.read("air");
```

## The 3-minute initial startup
On first power, the ENS160 runs an internal conditioning phase (~3 minutes). During this time `d.error = "initial start (~3min)"` and `d.ok = false`. After conditioning it switches to warm-up (seconds) then normal. This only happens once per power cycle — subsequent reads are instant.

## I2C addresses
Both sensors are on the same bus:
- **ENS160**: `0x52` (ADDR pin LOW) or `0x53` (ADDR pin HIGH)
- **AHT21**: `0x38` (fixed — cannot be changed)

Since AHT21 address is fixed, you can only have **one AHT21 per I2C bus**. For a second humidity sensor on the same bus, use SHT31 (0x44/0x45 selectable).

## What TVOC actually measures
TVOC (Total Volatile Organic Compounds) catches a broad range of gases: cleaning products, paint, adhesives, cooking fumes, perfume, off-gassing from new furniture, human breath. High TVOC in a room usually means ventilation needed.

## Gotchas
- **3.3V only** — do not supply 5V
- I2C at 400kHz is fine for this chip
- Don't mount near the ESP32's WiFi antenna — RF interference can cause spurious I2C reads
- Keep away from cooking areas if monitoring background air quality — cooking spikes are dramatic and take minutes to clear
