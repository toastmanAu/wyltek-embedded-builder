# BME280 / BMP280 — Temperature, Humidity & Pressure
**Driver:** `WyBME280.h`

---

## What it does
Measures air temperature, humidity, and barometric pressure. From those three you also get a calculated altitude. The BME280 is the full version (all three sensors). The BMP280 is the budget version — temperature and pressure only, no humidity. The driver handles both automatically.

## Why it's useful
- **Weather monitoring** — indoor/outdoor barometric pressure trends
- **Altitude estimation** — good to ~1m resolution in calm air
- **Environment control** — temperature + humidity for HVAC, grow rooms, server rooms

## Wiring

| BME280 Pin | ESP32 |
|-----------|-------|
| VCC | 3.3V |
| GND | GND |
| SDA | GPIO (any I2C SDA) |
| SCL | GPIO (any I2C SCL) |
| SDO/ADDR | GND for 0x76, 3.3V for 0x77 |
| CSB | 3.3V (forces I2C mode) |

The `SDO` pin sets the I2C address. Tie it to GND to get `0x76` (default), or to 3.3V to get `0x77`.

## I2C Addresses

| SDO Pin | Address |
|---------|---------|
| GND (or floating) | `0x76` |
| 3.3V | `0x77` |

## Specs

| Parameter | Value |
|-----------|-------|
| Temperature range | -40°C to +85°C |
| Temperature accuracy | ±1°C |
| Humidity range | 0–100% RH |
| Humidity accuracy | ±3% |
| Pressure range | 300–1100 hPa |
| Pressure accuracy | ±1 hPa |
| Current | ~3.6µA in normal mode |
| Interface | I2C (or SPI) |
| Chip ID | 0x60 (BME280), 0x58 (BMP280) |

## Code Example

```cpp
#include <WySensors.h>

WySensors sensors;

void setup() {
    // SDA=21, SCL=22, address 0x76
    sensors.addI2C<WyBME280>("weather", 21, 22, 0x76);
    sensors.begin();
}

void loop() {
    WySensorData d = sensors.read("weather");
    if (d.ok) {
        Serial.printf("Temp: %.1f°C  Humidity: %.1f%%  Pressure: %.1f hPa  Alt: %.0fm\n",
            d.temperature, d.humidity, d.pressure, d.altitude);
    }
    delay(2000);
}
```

## WySensorData fields

| Field | Content |
|-------|---------|
| `temperature` | Temperature in °C |
| `humidity` | Relative humidity 0–100% |
| `pressure` | Barometric pressure in hPa |
| `altitude` | Calculated altitude in metres (referenced to sea level at 1013.25 hPa) |
| `ok` | `true` if read succeeded |

## Gotchas

**BMP280 has no humidity.** The driver checks the chip ID at `begin()`. If it reads `0x58` (BMP280), humidity and altitude are not populated. Pressure and temperature still work.

**Chip ID mismatch.** You'll see `[BME280] unexpected chip ID 0xXX` on Serial if the address is wrong or the sensor isn't connected. Check your SDO pin and pull-up resistors.

**Heating from nearby components.** The BME280 reports the temperature of the die, which is influenced by heat from your ESP32 or other nearby components. Mount it away from heat sources. A short wire-and-header extension helps.

**Self-heating in normal mode.** The sensor runs continuously in normal mode. At low standby times it self-heats by 1–2°C. The default config (standby 1000ms) minimises this. If you need lower power, use forced mode (one-shot reads) — not yet exposed in the driver.

**Altitude requires sea-level calibration.** The altitude formula assumes sea level pressure is 1013.25 hPa. In reality it varies by ±30 hPa with weather. For accurate altitude, either correct the reference pressure or use a GPS for calibration.

**Multiple sensors on the same bus.** You can put a 0x76 and a 0x77 on the same I2C bus:
```cpp
sensors.addI2C<WyBME280>("indoor",  21, 22, 0x76);
sensors.addI2C<WyBME280>("outdoor", 21, 22, 0x77);
```

**Fake BME280 modules.** Cheap clones often have a BMP280 or BMP085 chip relabelled as BME280. If your humidity reads 0 or gives garbage, check the chip ID printed in Serial — if it's not `0x60`, you have a clone.
